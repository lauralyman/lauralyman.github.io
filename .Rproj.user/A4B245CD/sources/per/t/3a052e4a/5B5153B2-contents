---
title: "Homework 3"
author: "YOUR NAME HERE"
date: "Due Date Here"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, error = TRUE)
```

# Instructions

To complete your assignment, please follow these steps.

1. Download this Rmd file from Moodle and save it on your computer in a place that you can easily find again. 

2. Add your name and the due date to the YAML header at the start of this file. 
3. Open this Rmd file in RStudio. Make sure you've installed all necessary R packages (e.g., `dplyr`, `readr`, `ggplot2`). You can test this by running the first code chunk below. (If successful, no messages/errors should appear when running it.)

4. Ensure any data files (i.e., CSV or  Excel files included with the HW on Moodle) are saved in the *same location as this Rmd file.* 

# Relevant Reading
* Chapter 2 (Sections 2.1 - 2.3) in the \href{https://drive.google.com/file/d/1ZAZxMwMG07qcZGEq9RG7gcsTAVytBueR/view?usp=sharing}{\textcolor{blue}{\underline{textbook}}}


# Packages & Document Set-Up

```{r, message = FALSE, warning = FALSE}
library(readxl)  # Read excel files
library(readr)   # Read CSV files
library(dplyr)   # For functions like summarize
library(ggplot2) # For making plots
library(mosaic)  # Convenient interface to t.test function
library(Sleuth3) # For data from the book

# Print 10 significant digits in summarize output
options("pillar.sigfig" = 10) 
```


# Problem 1


A supermarket is implementing a new checkout system to reduce customer wait time. To assess the new system's effectiveness, the supermarket management conducted a study to measure customers' wait time for the current and new checkout systems. To do so, 20 \underline{pairs} of randomly selected customers who arrived at the same time in line, one at the current and one at the new checkout system, were asked to record their wait time until they arrived at the cashier. Their wait times were measured in seconds and are stored in the data frame `waittimes`.

```{r}
waittimes <- read_excel("waittimes.xlsx")
```


You are in charge of conducting a full analysis! The parts below provide some guidance. 


### (a) Create an informative plot with axis labels that are understandable to folks without backgrounds in statistics. 

\textcolor{blue}{Later in the problem, we will need to create a variable representing the difference in wait times between the old and new checkout systems, so we can do that now.}


```{r}
waittimes = waittimes %>% mutate(wt_diff = wt_new - wt_current)
```

\textcolor{blue}{Our plot can be a histogram of this difference in wait times.}
```{r,out.width="50%"}
waittimes %>% ggplot(aes(x = wt_diff)) + geom_histogram(bins = 12, fill = "purple") + 
              xlab("Difference in Wait Times Between Old and New Systems in Seconds
                   (New Wait Time - Old Wait Time)") + 
              ylab("Number of Customer Pairs") +
              theme_bw()
```

\textcolor{blue}{Alternatively, we can simply make two separate plots and look at them together.}

```{r,out.width="50%"}

plot_curr = waittimes %>% ggplot(aes(x = wt_current)) + 
            geom_histogram(bins = 15, fill = "blue") + 
            xlab("Wait Times of Current System (Seconds)") + 
            ylab("Number of Customers") +
            theme_bw()

plot_new = waittimes %>% ggplot(aes(x = wt_new)) +
           geom_histogram(bins = 15, fill = "red") + 
           xlab("Wait Times of New System (Seconds)") + 
           ylab("Number of Customers") +
           theme_bw()

library(patchwork)
plot_curr + plot_new + plot_layout(ncol = 2)
```


### (b) Calculate summary statistics (e.g., means, medians, ranges, standard deviations, etc.) that would be meaningful to someone who has *not* taken a statistics course.


```{r}
# Calculate summary statistics
waittimes %>% 
  summarize(mean_diff_waittime   = mean(wt_diff), 
            median_diff_waittime = median(wt_diff),
            std_diff_waittime    = sd(wt_diff))
```

### (c) Calculate a relevant 95% confidence interval. Interpret your confidence interval in the context of this example and its research question. **Explain what is meant by _95% confident_ as well.** 

* You do *not* need to compute the confidence interval by hand; you can use output from the `t.test` function. 
\

```{r}
# Calculate 95% CI here using t.test()
t.test(waittimes$wt_diff, mu = 0)
```

\textcolor{blue}{\textbf{Interpretation:} We are 95\% confident that the mean difference in wait time between the new and current checkout systems is between about -78.5 seconds (meaning the new system is 78.5 seconds slower on average) and 5.3 seconds (meaning the new system is 5.3 seconds faster on average). By 95\% confident, we mean that if we were to repeat this experiment on all possible samples of size $n = 20$ customer pairs, 95\% of those samples would have their confidence intervals capture the true mean difference in wait time between the two systems.}

### (d) Construct a relevant hypothesis test. 

* Explain the hypotheses symbolically \underline{and} in words.
* Explain how to interpret your p-value for this hypothesis test. Besides giving technical details, e.g., \emph{"The probability that we...}), explain what the p-value represents in the context of this example.

\textcolor{blue}{Interpretation of $p$-value: The $p$-value for this hypothesis test is the probability of getting a $t$-statistic as or more extreme than the one we observed in our data ($t_{\text{obs}} = -1.8283$) if in fact there were no difference in the average wait times of the current and new checkout systems. In context, it is the probability that we would observe a mean difference in wait time greater than BLAH or less than BLAH if BLAH BLAH BLAH}

### (e) What conclusions can be drawn about whether this new checkout system was a good idea?

Since the data does not provide strong evidence in favor of the null hypothesis, it can be true that the
current system, on average, takes more wait-time than the new system for the population of customers
like those included in the study. However, in general, there are 2 possibilities:
– The current system does take more wait-time on average than the new system for all pairs of
customers arriving at the same time like those in this study
– The current system takes the same wait-time on average as the new system for all pairs of customers
like those in this study, but we just happen to have an unusual sample.
• Population inference: With caution, we might be able to infer the results to the population of people
like those in this study since the 20 pairs are randomly selected customers. Additional information on
whether or not the researchers control potential confounding variables like (1) the amount of products
the preceding customers purchase (which may cause the wait-times to be longer) or (2) whether the
participants correctly recorded their waittime is not provided, so we cannot say for sure that the results
are generalizable.
• Causal inference:


# Problem 2 

Researchers took independent random samples from two different locations: Mount Holyoke College and Amherst College. They measured the number of geese they sighted in each location over different spans of time. The sample of $n_1 = 100$ days at Mount Holyoke (where each day is an _observational unit_) had an average of **2.5** geese sightings/days, while the sample of $n_2 = 120$ days at Amherst had an average of **1.8** geese sightings/day. The standard error of the difference between the two averages was **0.08** sightings/day with $n_1 + n_2 - 2 = 100 + 120 - 2 =$ **218** degrees of freedom.

### (a) From the information above, find a 95% confidence interval for $\mu_{\text{MHC}} - \mu_{\text{AC}}$ (the difference in mean number of geese sightings/day between MHC and Amherst College). Interpret the interval in context. *As part of your answer, explain what the phrase "95% confident" means.*

```{r}
# Find the 95% CI here
n1 = 100
n2 = 120
mu_hat_MHC = 2.5
mu_hat_AC = 1.8
SE = 0.08
alpha = 0.05

t_crit = qt(1 - alpha/2, df = n1 + n2 - 2, lower.tail = TRUE)

CI_LB = (mu_hat_MHC - mu_hat_AC) - t_crit * SE
CI_UB = (mu_hat_MHC - mu_hat_AC) + t_crit * SE

print(paste("95% CI: [", CI_LB, ",", CI_UB, "]"))
```

\textcolor{blue}{\textbf{Interpretation:} We are 95\% confident that the true difference ($\mu_{\text{MHC}} - \mu_{\text{AC}}$) in the average number of geese sightings/day between MHC and Amherst College is between about 0.54 and 0.86 sightings/day. By 95\% confident, we mean that if we were to repeat this experiment using all samples of $n_1 = 150$ days at MHC and $n_2 = 120$ days at Amherst College, and construct confidence intervals using each pair of these samples from the two schools, 95\% of those confidence intervals would contain the population parameter (the true mean difference in geese sightings/day between MHC and Amherst College).}


### (b) Find a \underline{90\%} confidence interval for $\mu_{\text{MHC}} - \mu_{\text{AC}}$. What changed in your calculation from (a)? Is this CI wider or narrower than the 95% CI from (a)? Note. You do *not* need to interpret your 90% CI. 

```{r}
# Find the 90% CI here
t_crit_90 = qt(1 - 0.1/2, df = n1 + n2 - 2, lower.tail = TRUE)

CI_LB = (mu_hat_MHC - mu_hat_AC) - t_crit_90 * SE
CI_UB = (mu_hat_MHC - mu_hat_AC) + t_crit_90 * SE

print(paste("90% CI: [", CI_LB, ",", CI_UB, "]"))
```

\textcolor{blue}{All that changes in our calculation is $t_{1-\alpha/2}^{(n_1 + n_2 -2)}$ (i.e., "t-critical"), since our $\alpha$ is now 0.1 instead of 0.05. Everything else (the observed means for each sample and the standard error) is the same!}

\textcolor{blue}{The confidence interval is narrower! \textbf{Students don't necessarily need to explain why (since the question forgot to ask about this), but here is the rationale}. We didn't change anything in our analysis other than the confidence level. By having a narrower confidence interval, we are being more specific about our predicted "reasonable" values for the population parameter --- but the cost of being more specific is that we have lower confidence. In general, \emph{holding everthing else fixed},}

* \textcolor{blue}{higher confidence $\Rightarrow$ wider CI.}

\textcolor{blue}{For intuition, we can think of an example from class. Let's say our population parameter is the true average age of all students in my STAT 242 class (and I'm not allowed to ask everyone for their ages, so the population parameter is unknown).}

* \textcolor{blue}{If I want (say) 100\% confidence, I will make my CI very wide: \emph{I am 100\% confident that the average age of students in STAT 242 is between 0 and 50 years old.}}

* \textcolor{blue}{If I am comfortable with having a lower confidence level, I can provide a more specific (i.e., narrower) range of values: \emph{I am 30\% confident that the average age of students in STAT 242 is between 19.5 and 20.5 years old.}}



### (c) Calculate the t-statistic for a test of the claim that there is *no* difference in the mean number of geese sightings/day between the two locations. What is the interpretation of this statistic in context?

**Note.** For an example of "interpreting a t-statistic in context", see pages 7 and 8 of these \href{https://drive.google.com/file/d/1b72_Os2QtESRRpXkeviFcF6ek1I9ga-t/view?usp=sharing}{\underline{\textcolor{blue}{posted notes}}}.

```{r}
# Calculate the t-statistic here
observed_mean_diff = mu_hat_MHC - mu_hat_AC
(t_obs = (observed_mean_diff - 0)/SE)
```

\textcolor{blue}{\textbf{Interpretation}: If there is truly no difference in the mean number of geese sightings/day between Mount Holyoke and Amherst College, the mean difference we observed (0.7 sightings/day) is 8.75 standard errors above this predicted difference of 0 sightings/day.} 

# Formatting

Several issues do not become apparent until you knit your Rmd file to a PDF.  Here are some common examples to look out for so that you avoid grading penalties:

* accidental code/data print outs for dozens of pages;
* import errors (e.g., *"`FILENAME` does not exist in current working directory*");
* plots appearing without the code that created them (e.g., from putting `echo = FALSE` in a code chunk);
* copy/pasted unicode characters (which will often appear as blank symbols, even if the document renders).

In summary, even if you are satisfied with your Rmd file, \underline{be sure to check the knitted PDF carefully} before submitting it.